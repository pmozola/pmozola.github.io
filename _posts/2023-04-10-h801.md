---
layout: post
title: H801
image: /img/h801/h801.jpg
bigimg: /img/h801/background.jpg
tags: [H801, Smarthome, Supla, HomeAssistant]
---


![Alt text](/img/h801/h801.jpg "bla bla bla")

# H801 RGBWW
## Wstęp
Jakiś czas w swoim domu probuje wprowadzić elementy "Smart", a kolejna rzecza ktora wybrałem do automatyzacji sa schody, a dokładniej oswietlenie led pod nimi. Po dobraniu odpowiednikch pasków ledów, profili i zasilacza(co nie było takim prostym zadaniem dla totalnego laika :) ) przyszedł czas na spięcie oświetlenia z domowym systemem automatyzacji, której role, na ta chwile, pełni Supla.
Poczatkowymi załozeniami były:
- uruchamianie oświetlenia godzine po zmroku(w momencie gdy zasłaniaja sie rolety zewnetrzne)
- wyłaczanie około 24(o tej godzinie domownicy przywaznie juz spią)
- na podstawie czujki w godzinach 24-6 rano uruchamianie oswietlenia zblizeniowo
- uruchamianie oswietlenia rano 5.30 do momentu automatycznego otworzenia sie rolet.
- uruchamienie led powinno nastepowac kaskadowo, jak na tym filmiku:
 ![schody](/img/h801/schody.gif "schody")

Istnieja gotowe rozwiazania - jak własnie SCR-2 firmy soled, jednak sa one raczej drogie, i ciezkie do zintegrowania z istniejacym systemem smarthome, dlatego na tapete wziałem chiński moduł H801 któy dostepny na alliexpres za około 50zł(na polskim allegro w granicach 80-100zł) Ten sterownik led posiada 5 kanałów wyjsciowych, wiec bez problemu mozemy go uzywac do tasm RGB, RGBWW badz tez po prostu podłaczyc 5 bialych pasków.
Za pomoca progamatora mozemy wgrac odpowiednie sterowniki, i  bezbolesnie zintegrowac sie z praktycznie kazda instiejaca instalacja smart-hkome. W dalszej czesci pokaze jak to zrobic na przykładzie "mojej" Supli


## Czego potrzebujemy ?
 - programator usb->uart Cp2102 (20zł na allegro)
 - sterownik do usb dla cp 2102 
 ![cp2102](/img/h801/cp2102.jpg "cp2102")
 - odpowiedni soft do h801
 - apka do flashowania waszego modułu -> [http://bbs.espressif.com/download/file.php?id=385][Flash download tool] 
 - przewody połaczeniowe żensko-męskie(dla własnej wygody 5zł/40 szt)  ![przewod](/img/h801/przewod.jpg "przewod")


## Do dzieła!

### przygotowanie urzadzenia

rozkrecamy moduł h801, i podłączamy do programatora - 
- tx do tx , rx do rx, 3v i uziemienie
![kabelki](/img/h801/programowanie.jpg "kabelki")
- j3 zaznaczone na czerwono łaczymy ze soba zeby wprowadzic urzadzenie w tryb konfiguracji
![konfig](/img/h801/modulj3.jpg "konfig")
- podlaczamy do komputera przez port usb :)

### przygotowanie i wgranie softu

sa z racji tego ze sterownik moze działac jako rgbww, albo wwwww, albo jak sobie wymyslimy, mozemy uzyc gotowy soft albo sami go stworzyc za pomoca generatora, pokaze obydwa sposoby : )

#### 1 Wgranie gotowego softu
- sciagamy soft z githuba ->  [https://github.com/SUPLA/ESP8266/tree/master/H801][Link do 801] 
- sciagamy esp_init -> [https://github.com/SUPLA/ESP8266/tree/master/H801][Link] 
- instalujemy sterowniki do naszego programatora jezeli wczesniej tego nie zrobilismy(np z tad [http://bbs.espressif.com/download/file.php?id=385][Link] ) 
- odpalamy flashtoola i ustawiamy zgodnie z plikiem readme dostepnym w 1 linku ![przewod](/img/h801/config.png "przewod")
- odpalamy, czekamy i cieszymy sie wgranym softem :)
- podłączamy nasze urzadzenie do pradu, powinna pojawic sie nowa siec wifi - suplaxxxxx, z ktora sie łaczymy
- wchodzimy na strone 192.168.4.1
- wpisujemy server supli, nazwe wifi, hasło itd. zapisujemy restartujemy urzadzenie
- w naszej supli powinna pojawic sie nowa ikonka z mozliwoscia wlaczenia ledów i ustawniena koloru paska

#### 2 Stworzenie własnego softu
Supla dostarcza cudowny generator softu do roznego typu płytek, tutaj przedstawie sposob konfiguracji generatora dla tasm 5x bialych(WWWWWW)

- wchodzimy na strone https://gui-generic-builder.supla.io/ i zaznaczamy 
  - Płytka -> H801
  - powinny autmatycznie zaznaczyc sie opcje Konfiguracja, aktualizacja przez www, dostepne GUI, Led Załaczenia przekaznika, RGBW,RGB,DImmer
  - klikamy generuj
  - po chwili powinno pojawic sie nam okienko z mozliwoscia sciagniecia softu albo z jego instalacji
  [instalacja](/img/h801/GUI-Generic%20Builder-installer.png "instalacja")
  - klikamy instaluj wybieramy port do ktorego mamy podpiety programator, czekamy chwile - i gotowe
  teraz przyszedł czas na konfiguracje urzadzenia do tasm wwwww.
- podłączamy nasze urzadzenie do pradu, i powinna pojawic sie nowa siec wifi - suplaxxxxx, z ktora sie łaczymy
- wchodzimy na strone 192.168.4.1
- wpisujemy server supli, nazwe wifi, hasło itd.
- po zapisaniu ustawien wchodzimy do "innych" ustawien zeby skonfigurowac urzadzenie w trybie wwwww    [dimmer](/img/h801/dimmer.jpg "dimmer")
- wybieramy ilosc 5 (zapisujemy), wyłaczamy wszystkie opcje red/green/blue na kazdym przycisku
- w white/dimmer ustawiamy odpowiedni port zgodnie z rozpiska 

| przycisk | GPIO | port |
| -------- | ---- | ---- |
| 1 | GPIO12 |	PWM 3 |
| 2 | GPIO13 |	PWM 2 |
| 3 | GPIO14 |	PWM 4 |
| 4 | GPIO15 |	PWM 1 |
| 5 | GPIO04 |	PWM 5 |

  - zapisujemy i cieszymy sie 5 osobnymi kanałami w aplikacji


# That's all folks

To koniec, wrzucilismy soft do naszej nowej "zanbawki" spielismy to z systemem Supli, i teraz mozemy cieszyc sie z zdalnego sterowania naszymi ledami, przez apke :) 